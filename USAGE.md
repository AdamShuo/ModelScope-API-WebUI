# ModelScope API WebUI 使用指南

## 🎯 快速上手

### 首次使用步骤

1. **获取API Token**
   - 访问 [魔搭社区](https://modelscope.cn) 注册账号
   - 绑定阿里云账号获取每日2000次免费调用
   - 在[访问令牌页面](https://modelscope.cn/my/myaccesstoken)创建令牌

2. **启动应用**
   - Windows：双击 `run_windows_smart.bat`
   - Linux/macOS：运行 `./run_linux_smart.sh`

3. **配置API Token**
   - 在任意功能模块中输入您的API Token
   - 勾选"保存API Token到浏览器缓存"
   - 开始使用各项AI功能

## 🎨 功能模块详解

### 1. 文生图 (Text-to-Image)

#### 基本使用
1. **输入提示词**：描述您想要生成的图像内容
2. **选择模型**：从下拉列表中选择合适的图像生成模型
3. **调整参数**：
   - **图像尺寸**：设置生成图像的宽度和高度（256-2048px）
   - **采样步数**：影响图像质量（1-100，推荐20-50）
   - **引导系数**：控制提示词的影响强度（1.0-20.0，推荐7.5）
   - **随机种子**：固定值可复现相同结果（-1为随机）

#### 高级功能
- **元数据嵌入**：勾选"包含生成参数"可将参数保存到图像EXIF中
- **参数保存**：点击"保存参数"将当前设置保存为JSON文件
- **参数加载**：上传包含元数据的图片或JSON文件自动填充参数

### 2. 图像编辑 (Image Editing)

#### 基本使用
1. **上传原图**：选择要编辑的图像文件
2. **输入编辑提示**：描述您想要进行的修改
3. **调整参数**：与文生图类似的参数设置

#### 特殊功能
- **自适应比例**：自动保持原图宽高比
- **尺寸信息**：实时显示输入图像的尺寸信息
- **参数继承**：可从原图自动继承生成参数（如果包含元数据）

### 3. 文本对话 (Text Chat)

#### 基本使用
1. **输入消息**：在对话框输入您的问题或指令
2. **系统提示**：可自定义系统角色设定
3. **参数调节**：
   - **温度**：控制回答的随机性（0.1-2.0）
   - **最大Token**：限制回答长度（100-8000）

### 4. 图生文 (Image-to-Text)

#### 基本使用
1. **上传图像**：选择要分析的图片
2. **输入提示**：可自定义分析要求
3. **获取结果**：系统会生成图像描述或回答视觉问题

### 5. Photopea 在线编辑器

#### 功能特点
- **专业工具**：图层、滤镜、画笔等完整图像编辑功能
- **格式支持**：PSD、XCF、Sketch等多种专业格式
- **无需安装**：直接在浏览器中使用，完全免费

#### 使用步骤
1. 点击"打开Photopea"按钮
2. 在弹出窗口中编辑图像
3. 保存编辑结果后返回主应用

### 6. 手绘白板

#### Excalidraw
- **简洁风格**：手绘风格的矢量绘图工具
- **图形绘制**：支持基本图形、箭头、文本标注
- **协作功能**：支持多人实时编辑

#### tldraw
- **现代界面**：功能丰富的现代化白板
- **多种模式**：自由绘制、图形、文本等多种模式
- **状态保持**：切换工具时保持编辑状态

## ⚙️ 参数配置详解

### 图像生成参数

| 参数 | 推荐范围 | 说明 |
|------|----------|------|
| 图像尺寸 | 512-1024px | 尺寸越大生成时间越长，质量可能更高 |
| 采样步数 | 20-50 | 步数越多细节越丰富，但生成时间增加 |
| 引导系数 | 7.0-10.0 | 值越大越遵循提示词，但可能过度饱和 |
| 随机种子 | -1或固定值 | 固定值可复现相同结果，-1为随机 |

### 文本生成参数

| 参数 | 推荐范围 | 说明 |
|------|----------|------|
| 温度 | 0.7-1.0 | 值越小回答越确定，值越大越有创造性 |
| 最大Token | 1000-4000 | 控制回答长度，根据问题复杂度调整 |

## 🔧 高级技巧

### 元数据功能使用技巧

1. **参数复用**：保存成功的参数设置，用于后续类似任务
2. **批量处理**：使用相同参数生成系列图像保持风格一致
3. **实验记录**：保存不同参数组合便于对比效果

### 提示词编写技巧

1. **具体描述**：使用详细、具体的描述词
2. **风格指定**：明确指定艺术风格（如"油画风格"、"动漫风格"）
3. **负面提示**：使用负面提示词排除不想要的内容
4. **权重控制**：重要词汇可重复或使用强调语法

### 图像编辑技巧

1. **局部编辑**：使用具体提示词针对图像特定区域进行编辑
2. **风格转换**：保持内容不变，只改变艺术风格
3. **细节增强**：使用"高清"、"细节丰富"等提示词提升质量

## 🐛 常见问题解决

### API相关问题

**Q: API请求失败怎么办？**
A: 
1. 检查API Token是否正确
2. 确认网络连接正常
3. 查看每日调用额度是否用完
4. 尝试重新启动应用

**Q: 图像生成超时怎么办？**
A:
1. 减小图像尺寸
2. 降低采样步数
3. 检查网络连接稳定性

### 技术问题

**Q: 应用无法启动怎么办？**
A:
1. 确保系统已安装Python 3.8+
2. 尝试运行 `python setup.py` 安装环境
3. 检查系统权限是否足够

**Q: 依赖安装失败怎么办？**
A:
1. 更新pip到最新版本：`python -m pip install --upgrade pip`
2. 尝试使用国内镜像源
3. 检查Python版本兼容性

### 功能问题

**Q: 元数据功能不工作怎么办？**
A:
1. 确保勾选了"包含生成参数"选项
2. 检查图像格式是否支持EXIF（JPEG、PNG、WEBP）
3. 使用专业图像查看器检查元数据

**Q: 参数加载失败怎么办？**
A:
1. 确认文件格式正确（JSON或支持元数据的图像）
2. 检查文件是否损坏
3. 尝试重新保存参数文件

## 💡 最佳实践

### 工作效率提升

1. **模板化参数**：为常用任务创建参数模板
2. **批量处理**：使用相同参数处理多个任务
3. **结果对比**：保存不同参数的结果便于选择最佳方案

### 资源优化

1. **合理使用额度**：优先测试小尺寸图像，确认效果后再生成大图
2. **参数优化**：找到效果与效率的最佳平衡点
3. **缓存利用**：合理使用浏览器缓存提升加载速度

### 安全使用

1. **Token保护**：不要分享您的API Token
2. **文件安全**：定期清理临时文件
3. **隐私保护**：避免上传敏感个人信息到公共服务器

## 🔮 进阶功能

### 自定义模型配置

编辑 `modelscope_config.json` 文件可添加自定义模型：

```json
{
  "image_models": ["您的自定义模型"],
  "default_model": "您的默认模型"
}
```

### 界面自定义

通过修改Gradio界面代码可自定义：
- 主题颜色和样式
- 布局排列方式
- 功能模块组合

### 扩展开发

项目采用模块化架构，可轻松添加新功能模块：
1. 在 `modules/` 文件夹创建新模块
2. 实现功能逻辑和界面
3. 在主文件中集成新模块

---

**提示**：本使用指南会随版本更新而调整，建议定期查看最新版本以获取最新功能信息。